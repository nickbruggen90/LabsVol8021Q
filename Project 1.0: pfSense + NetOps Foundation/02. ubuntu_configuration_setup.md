### Ubuntu Server Creation and Configuration
1. Create the Ubuntu VM inside **VMWare Workstation Pro**. Use the official Ubuntu Live Server .iso release.
```
2 GB RAM
1 processors, 2 cores
VMNet2 network adapter
default on the rest is fine
```

2. Once it boots up and you reach `Network Configurations`:
```
a. You will choose an IP within the subnet of the VLAN 1. In this instance it will be 192.168.83.2
b. The gateway will be the IP of the VLANs default gateway (VLAN1) - 192.168.83.1
c. 8.8.8.8 will be the DNS server for this lab
```

3. Install `net-tools`. This installs network related CLI commands.
```
a. sudo apt install net-tools
b. ifconfig -a
```

4. Next, let's install SNMP on the Ubuntu server. We will also need to allow SNMP on pfSense in future steps. Inside the Ubuntu Server VM:
```
sudo apt install snmp snmp-mibs-downloader
```
`For human-readable format, you can comment out #mibs in the /etc/snmp/snmp.conf file â†’ `
##### Before: 
![mibs output 1](https://github.com/nickbruggen90/LabsVol8021Q/blob/main/Project%201%3A%20NetOps%20Monitoring/Images/Screenshot%202025-05-29%20185249.png)
##### After:
![mibs output 2](https://github.com/nickbruggen90/LabsVol8021Q/blob/main/Project%201%3A%20NetOps%20Monitoring/Images/Screenshot%202025-05-29%20185400.png)

5. Next, let's install Syslog and confirm it's active. Similar with SNMP, we will need to allow it on pfSense in future steps.
```
sudo apt update
sudo apt install rsyslog
sudo systemctl status rsyslog
```
![syslog active 1](https://github.com/nickbruggen90/LabsVol8021Q/blob/main/Project%201%3A%20NetOps%20Monitoring/Images/Screenshot%202025-05-31%20071256.png)

6. We must also create and define log files and directories.
```
sudo mkdir /var/log
sudo touch /var/log/pfsense.log
sudo vim /etc/rsyslog.d/10-pfsense.conf
```

7. Add the following lines to the .conf file:
```
if ($fromhost-ip == '192.168.83.226') then /var/log/pfsense.log
& stop
```
8. Last for rsyslog, we need to allow the UDP connection. `sudo vim /etc/rsyslog.conf` and remove the `#` comments from:
```
module(load="imudp")
input(type="imudp" port="514" address="192.168.83.2")
```

9. Restart Syslog with *sudo systemctl restart rsyslog* - and also power down the VM.
10. While the VM is powered down, now is a good opportunity to create a shared folder between the VM and the host machine.
[You can find the Shared Folder Guide here](https://github.com/nickbruggen90/LabsVol8021Q/blob/main/Project%201.0%3A%20pfSense%20%2B%20NetOps%20Foundation/Troubleshooting/Creating%20A%20Shared%20Folder%20In%20Ubuntu.md)

### Virtual Environment Creating and Installing Python
`We will need to install Paramiko and SCP inside a virtual environment (VENV) to allow it to function.`
1. First, inside the Ubuntu Server VM:
```
sudo apt install python3-venv -y
python3 -m venv ~/netops-venv
source ~/netops-venv/bin/activate
which python
pip install --upgrade pip
pip install netmiko paramiko scp
deactivate
```

2. Now we must create a Paramiko Python script for testing. VS Code is a good option for scripting. Below is a sample Paramiko Python script:
```
#This script parses device inforamation using Python and Paramiko
import paramiko

hostname = '192.168.83.226'
username = 'admin'
password = 'pfsense'

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

commands = [
    'uptime',
    'hostname',
    'netstat -rn',
    'df -h',
    'ifconfig',
]

try:
    print("Connecting to pfSense...")
    ssh.connect(hostname, username=username, password=password)

    for cmd in commands:
        print(f"Executing command: {cmd}")
        stdin, stdout, stderr = ssh.exec_command(cmd)

        exit_status = stdout.channel.recv_exit_status()

        if exit_status == 0:
            output_lines = stdout.readlines()
            if output_lines:
                print("".join(output_lines))
            else:
                print("No output returned.")

        else:
            error_lines = stderr.readlines()
            print(f"Command failed with exit status {exit_status}.")
            print("".join(error_lines))
                
    ssh.close()
    print("Connection closed.")

except Exception as e:
    print(f"An error occurred: {e}")
```

3. To execute this script, we need to add the script to the shared folder for accessibility and allow for SSH connections through pfSense.
4. Return to Ubuntu CLI to confirm script is in the appropriate place.  
`ls -la /mnt/hgfs/"name of shared folder"`  
5. Save this test script as `python.py`
6. [Now we need to return to the pfSense GUI to allow Syslog, SNMP and SSH connections.]LINK!!
